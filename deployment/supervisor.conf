# Supervisor configuration for Reshift No-Code Platform
# Place this file at /etc/supervisor/conf.d/reshift.conf

[program:reshift-backend]
command=/opt/reshift/backend/venv/bin/uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
directory=/opt/reshift/backend
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/reshift/backend.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
environment=PATH="/opt/reshift/backend/venv/bin",PYTHONPATH="/opt/reshift/backend"

[program:reshift-frontend]
command=npm run preview -- --host 0.0.0.0 --port 3000
directory=/opt/reshift/frontend
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/reshift/frontend.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
environment=NODE_ENV=production

# Optional: Add a process to handle file uploads and static file serving
[program:reshift-assets]
command=/opt/reshift/backend/venv/bin/python -m http.server 8080
directory=/opt/reshift/uploads
user=www-data
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/reshift/assets.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
